## 二 技术设计

### 2.1 系统架构概述

本项目采用前后端分离的三层架构设计，各层次的功能和职责清晰分明：

```
SHU智能问答系统架构
│
├── Layer 1: 表现层 (Presentation Layer)
│   ├── 用户界面 (HTML/CSS/JS)
│   │   ├── 对话界面
│   │   └── 图片预览
│   ├── 响应式布局 (Tailwind CSS)
│   │   ├── 移动端适配
│   │   └── 桌面端适配
│   └── 交互功能
│       ├── 实时对话
│       └── 图片放大
│
├── Layer 2: 业务层 (Business Layer)
│   ├── FastAPI 服务
│   │   ├── 路由控制
│   │   └── 流式响应
│   ├── RAG 系统
│   │   ├── 知识检索
│   │   └── 答案生成
│   └── DeepSeek API
│       ├── 模型调用
│       └── 参数配置
│
└── Layer 3: 数据层 (Data Layer)
    ├── 知识库
    │   ├── JSON 数据
    │   └── 图片资源
    ├── 向量索引
    │   ├── FAISS 库
    │   └── 文本向量
    └── 会话管理
        ├── 对话历史
        └── 状态追踪
```

### 2.2 核心技术介绍

#### 2.2.1 大语言模型技术

大语言模型（LLM）是一种基于深度学习的自然语言处理模型，通过对海量文本数据的训练，能够理解和生成人类语言。其核心原理是使用 Transformer 架构，通过自注意力机制处理输入文本的上下文关系，从而理解文本的深层语义。在训练过程中，模型通过多头注意力和位置编码等机制，学习了语言的语法规则、知识关系和逻辑推理能力。

在实际应用中，大语言模型采用预训练-微调范式，通过海量文本数据的自监督学习获取语言知识，再通过特定任务的微调适应具体应用场景。模型使用上下文窗口来处理长文本，通过注意力权重分布捕捉关键信息，并利用残差连接和层归一化等技术保证训练的稳定性。然而，大语言模型也面临着幻觉和知识时效性等挑战，这促使了检索增强生成技术的发展。

#### 2.2.2 检索增强生成技术

检索增强生成（Retrieval-Augmented Generation, RAG）技术是一种将信息检索系统与生成模型相结合的方法。其工作原理基于双编码器架构，包括检索编码器和生成编码器。在检索阶段，系统使用稠密检索技术，通过最大内积搜索快速定位相关文档。检索到的文档经过重排序和上下文融合，作为生成模型的输入增强。

这种方法通过知识分离策略，将参数化知识和非参数化知识分开存储和更新，有效解决了大语言模型的知识时效性问题。同时，通过引入外部知识库，RAG系统实现了可控性和可解释性的提升，并大大降低了计算资源需求。系统还支持知识库的增量更新和冷启动处理。

#### 2.2.3 向量检索技术

向量检索是现代信息检索系统的核心技术之一，基于语义空间映射原理。在向量化阶段，系统使用预训练语言模型通过上下文表示学习将文本转换为高维向量。这些向量通过余弦相似度（Cosine Similarity）或欧氏距离（Euclidean Distance）进行相似度计算。

为了提高检索效率，系统采用了近似最近邻搜索技术。FAISS通过产品量化和倒排索引等技术，实现了次线性时间复杂度的检索。同时，系统还支持多粒度索引和动态索引更新，以适应不同规模的数据集和实时更新需求。

#### 2.2.4 流式响应技术

流式响应是一种基于事件驱动架构的实时数据传输技术。它通过HTTP/2的服务器推送（Server Push）特性或Server-Sent Events（SSE）协议实现持久连接（Persistent Connection）。在实现过程中，采用了背压机制（Backpressure Mechanism）来控制数据流速，确保系统稳定性。

这种技术通过异步I/O（Asynchronous I/O）和事件循环机制，实现了高效的非阻塞数据传输。在大语言模型应用中，它支持令牌级流式传输，使用缓冲策略优化传输效率，同时通过心跳机制维护连接状态，确保了实时性和可靠性。

### 2.3 技术选型考虑

在技术选型过程中，我们综合考虑了性能、可维护性、开发效率和用户体验等多个因素。FastAPI框架的选择基于其出色的异步处理能力和自动API文档生成功能。向量检索使用FAISS库是因为其在大规模向量检索场景下表现优异，且内存占用相对较低。前端采用Tailwind CSS框架则是看中了其原子化CSS的特点，可以快速构建响应式界面，同时保持较小的打包体积。

### 2.4 技术整合

这些技术的整合形成了一个完整的智能问答系统。用户的问题首先经过向量化处理，然后通过FAISS进行相似度检索，获取相关的知识库内容。这些内容连同原始问题一起提供给大语言模型，生成准确的回答。整个过程通过流式响应技术实时呈现给用户，提供流畅的对话体验。同时，系统的模块化设计使得各个组件可以独立升级和优化，保证了系统的可维护性和可扩展性。
